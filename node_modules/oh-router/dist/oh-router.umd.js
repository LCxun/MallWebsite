(function(L,g){typeof exports=="object"&&typeof module!="undefined"?g(exports):typeof define=="function"&&define.amd?define(["exports"],g):(L=typeof globalThis!="undefined"?globalThis:L||self,g(L.oh={}))})(this,function(L){"use strict";var Se=Object.defineProperty;var Te=(L,g,y)=>g in L?Se(L,g,{enumerable:!0,configurable:!0,writable:!0,value:y}):L[g]=y;var M=(L,g,y)=>(Te(L,typeof g!="symbol"?g+"":g,y),y);function g(){return g=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},g.apply(this,arguments)}var y;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(y||(y={}));var C=function(e){return e},V="beforeunload",te="hashchange",G="popstate";function K(e){e===void 0&&(e={});var n=e,t=n.window,r=t===void 0?document.defaultView:t,a=r.history;function i(){var l=r.location,o=l.pathname,c=l.search,m=l.hash,v=a.state||{};return[v.idx,C({pathname:o,search:c,hash:m,state:v.usr||null,key:v.key||"default"})]}var s=null;function h(){if(s)w.call(s),s=null;else{var l=y.Pop,o=i(),c=o[0],m=o[1];if(w.length){if(c!=null){var v=u-c;v&&(s={action:l,location:m,retry:function(){P(v*-1)}},P(v))}}else A(l)}}r.addEventListener(G,h);var p=y.Pop,b=i(),u=b[0],$=b[1],R=W(),w=W();u==null&&(u=0,a.replaceState(g({},a.state,{idx:u}),""));function _(l){return typeof l=="string"?l:I(l)}function j(l,o){return o===void 0&&(o=null),C(g({pathname:$.pathname,hash:"",search:""},typeof l=="string"?O(l):l,{state:o,key:D()}))}function U(l,o){return[{usr:l.state,key:l.key,idx:o},_(l)]}function E(l,o,c){return!w.length||(w.call({action:l,location:o,retry:c}),!1)}function A(l){p=l;var o=i();u=o[0],$=o[1],R.call({action:p,location:$})}function f(l,o){var c=y.Push,m=j(l,o);function v(){f(l,o)}if(E(c,m,v)){var k=U(m,u+1),H=k[0],S=k[1];try{a.pushState(H,"",S)}catch{r.location.assign(S)}A(c)}}function d(l,o){var c=y.Replace,m=j(l,o);function v(){d(l,o)}if(E(c,m,v)){var k=U(m,u),H=k[0],S=k[1];a.replaceState(H,"",S),A(c)}}function P(l){a.go(l)}var x={get action(){return p},get location(){return $},createHref:_,push:f,replace:d,go:P,back:function(){P(-1)},forward:function(){P(1)},listen:function(o){return R.push(o)},block:function(o){var c=w.push(o);return w.length===1&&r.addEventListener(V,z),function(){c(),w.length||r.removeEventListener(V,z)}}};return x}function ne(e){e===void 0&&(e={});var n=e,t=n.window,r=t===void 0?document.defaultView:t,a=r.history;function i(){var o=O(r.location.hash.substr(1)),c=o.pathname,m=c===void 0?"/":c,v=o.search,k=v===void 0?"":v,H=o.hash,S=H===void 0?"":H,T=a.state||{};return[T.idx,C({pathname:m,search:k,hash:S,state:T.usr||null,key:T.key||"default"})]}var s=null;function h(){if(s)w.call(s),s=null;else{var o=y.Pop,c=i(),m=c[0],v=c[1];if(w.length){if(m!=null){var k=u-m;k&&(s={action:o,location:v,retry:function(){x(k*-1)}},x(k))}}else f(o)}}r.addEventListener(G,h),r.addEventListener(te,function(){var o=i(),c=o[1];I(c)!==I($)&&h()});var p=y.Pop,b=i(),u=b[0],$=b[1],R=W(),w=W();u==null&&(u=0,a.replaceState(g({},a.state,{idx:u}),""));function _(){var o=document.querySelector("base"),c="";if(o&&o.getAttribute("href")){var m=r.location.href,v=m.indexOf("#");c=v===-1?m:m.slice(0,v)}return c}function j(o){return _()+"#"+(typeof o=="string"?o:I(o))}function U(o,c){return c===void 0&&(c=null),C(g({pathname:$.pathname,hash:"",search:""},typeof o=="string"?O(o):o,{state:c,key:D()}))}function E(o,c){return[{usr:o.state,key:o.key,idx:c},j(o)]}function A(o,c,m){return!w.length||(w.call({action:o,location:c,retry:m}),!1)}function f(o){p=o;var c=i();u=c[0],$=c[1],R.call({action:p,location:$})}function d(o,c){var m=y.Push,v=U(o,c);function k(){d(o,c)}if(A(m,v,k)){var H=E(v,u+1),S=H[0],T=H[1];try{a.pushState(S,"",T)}catch{r.location.assign(T)}f(m)}}function P(o,c){var m=y.Replace,v=U(o,c);function k(){P(o,c)}if(A(m,v,k)){var H=E(v,u),S=H[0],T=H[1];a.replaceState(S,"",T),f(m)}}function x(o){a.go(o)}var l={get action(){return p},get location(){return $},createHref:j,push:d,replace:P,go:x,back:function(){x(-1)},forward:function(){x(1)},listen:function(c){return R.push(c)},block:function(c){var m=w.push(c);return w.length===1&&r.addEventListener(V,z),function(){m(),w.length||r.removeEventListener(V,z)}}};return l}function ae(e){e===void 0&&(e={});var n=e,t=n.initialEntries,r=t===void 0?["/"]:t,a=n.initialIndex,i=r.map(function(f){var d=C(g({pathname:"/",search:"",hash:"",state:null,key:D()},typeof f=="string"?O(f):f));return d}),s=J(a==null?i.length-1:a,0,i.length-1),h=y.Pop,p=i[s],b=W(),u=W();function $(f){return typeof f=="string"?f:I(f)}function R(f,d){return d===void 0&&(d=null),C(g({pathname:p.pathname,search:"",hash:""},typeof f=="string"?O(f):f,{state:d,key:D()}))}function w(f,d,P){return!u.length||(u.call({action:f,location:d,retry:P}),!1)}function _(f,d){h=f,p=d,b.call({action:h,location:p})}function j(f,d){var P=y.Push,x=R(f,d);function l(){j(f,d)}w(P,x,l)&&(s+=1,i.splice(s,i.length,x),_(P,x))}function U(f,d){var P=y.Replace,x=R(f,d);function l(){U(f,d)}w(P,x,l)&&(i[s]=x,_(P,x))}function E(f){var d=J(s+f,0,i.length-1),P=y.Pop,x=i[d];function l(){E(f)}w(P,x,l)&&(s=d,_(P,x))}var A={get index(){return s},get action(){return h},get location(){return p},createHref:$,push:j,replace:U,go:E,back:function(){E(-1)},forward:function(){E(1)},listen:function(d){return b.push(d)},block:function(d){return u.push(d)}};return A}function J(e,n,t){return Math.min(Math.max(e,n),t)}function z(e){e.preventDefault(),e.returnValue=""}function W(){var e=[];return{get length(){return e.length},push:function(t){return e.push(t),function(){e=e.filter(function(r){return r!==t})}},call:function(t){e.forEach(function(r){return r&&r(t)})}}}function D(){return Math.random().toString(36).substr(2,8)}function I(e){var n=e.pathname,t=n===void 0?"/":n,r=e.search,a=r===void 0?"":r,i=e.hash,s=i===void 0?"":i;return a&&a!=="?"&&(t+=a.charAt(0)==="?"?a:"?"+a),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function O(e){var n={};if(e){var t=e.indexOf("#");t>=0&&(n.hash=e.substr(t),e=e.substr(0,t));var r=e.indexOf("?");r>=0&&(n.search=e.substr(r),e=e.substr(0,r)),e&&(n.pathname=e)}return n}function re(e){if(!Array.isArray(e))throw new TypeError("Middleware stack must be an array!");for(const n of e)if(typeof n!="function")throw new TypeError("Middleware must be composed of functions!");return function(n,t){let r=-1;return a(0);function a(i){if(i<=r)return Promise.reject(new Error("next() called multiple times"));r=i;let s=e[i];if(i===e.length&&(s=t),!s)return Promise.resolve();try{return Promise.resolve(s(n,a.bind(null,i+1)))}catch(h){return Promise.reject(h)}}}}class ie{constructor(){M(this,"events",{})}on(n,t){return this.events[n]||(this.events[n]=[]),this.events[n].push(t),this}emit(n,...t){return this.events[n]?(this.events[n].forEach(a=>a.apply(this,t)),this):this}remove(n,t){if(!t)return this.events[n]=[],this;const r=this.events[n].indexOf(t);return this.events[n].splice(r,1),this}once(n,t){const r=(...a)=>{t.apply(this,a),this.remove(n,r)};return this.on(n,r),this}}function Q(e){return e==null}function X(e,n){if(!e)throw new Error(n)}function F(e,n){if(!e){typeof console!="undefined"&&console.warn(n);try{throw new Error(n)}catch{}}}const Y={};function oe(e,n,t){!n&&!Y[e]&&(Y[e]=!0,F(!1,t))}function se(e,n,t="/"){let r=typeof n=="string"?O(n):n,a=q(r.pathname||"/",t);if(a==null)return null;let i=Z(e);ce(i);let s=null;for(let h=0;s==null&&h<i.length;++h)s=ge(i[h],a);return s}function Z(e,n=[],t=[],r=""){return e.forEach((a,i)=>{let s={relativePath:a.path||"",caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};s.relativePath.startsWith("/")&&(X(s.relativePath.startsWith(r),`Absolute route path "${s.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),s.relativePath=s.relativePath.slice(r.length));let h=B([r,s.relativePath]),p=t.concat(s);a.children&&a.children.length>0&&(X(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),Z(a.children,n,p,h)),!(a.path==null&&!a.index)&&n.push({path:h,score:me(h,a.index),routesMeta:p})}),n}function ce(e){e.sort((n,t)=>n.score!==t.score?t.score-n.score:ve(n.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const le=/^:\w+$/,he=3,ue=2,fe=1,pe=10,de=-2,N=e=>e==="*";function me(e,n){let t=e.split("/"),r=t.length;return t.some(N)&&(r+=de),n&&(r+=ue),t.filter(a=>!N(a)).reduce((a,i)=>a+(le.test(i)?he:i===""?fe:pe),r)}function ve(e,n){return e.length===n.length&&e.slice(0,-1).every((r,a)=>r===n[a])?e[e.length-1]-n[n.length-1]:0}function ge(e,n){let{routesMeta:t}=e,r={},a="/",i=[];for(let s=0;s<t.length;++s){let h=t[s],p=s===t.length-1,b=a==="/"?n:n.slice(a.length)||"/",u=ye({path:h.relativePath,caseSensitive:h.caseSensitive,end:p},b);if(!u)return null;Object.assign(r,u.params);let $=h.route;i.push({params:r,pathname:B([a,u.pathname]),pathnameBase:$e(B([a,u.pathnameBase])),route:$}),u.pathnameBase!=="/"&&(a=B([a,u.pathnameBase]))}return i}function ye(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,r]=be(e.path,e.caseSensitive,e.end),a=n.match(t);if(!a)return null;let i=a[0],s=i.replace(/(.)\/+$/,"$1"),h=a.slice(1);return{params:r.reduce((b,u,$)=>{if(u==="*"){let R=h[$]||"";s=i.slice(0,i.length-R.length).replace(/(.)\/+$/,"$1")}return b[u]=we(h[$]||"",u),b},{}),pathname:i,pathnameBase:s,pattern:e}}function be(e,n=!1,t=!0){F(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/:(\w+)/g,(s,h)=>(r.push(h),"([^\\/]+)"));return e.endsWith("*")?(r.push("*"),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a+=t?"\\/*$":"(?:(?=[.~-]|%[0-9A-F]{2})|\\b|\\/|$)",[new RegExp(a,n?void 0:"i"),r]}function we(e,n){try{return decodeURIComponent(e)}catch(t){return F(!1,`The value for the URL param "${n}" will not be decoded because the string "${e}" is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Pe(e,n="/"){let{pathname:t,search:r="",hash:a=""}=typeof e=="string"?O(e):e;return{pathname:t?t.startsWith("/")?t:xe(t,n):n,search:ke(r),hash:He(a)}}function xe(e,n){let t=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function Le(e,n,t){let r=typeof e=="string"?O(e):e,a=e===""||r.pathname===""?"/":r.pathname,i;if(a==null)i=t;else{let h=n.length-1;if(a.startsWith("..")){let p=a.split("/");for(;p[0]==="..";)p.shift(),h-=1;r.pathname=p.join("/")}i=h>=0?n[h]:"/"}let s=Pe(r,i);return a&&a!=="/"&&a.endsWith("/")&&!s.pathname.endsWith("/")&&(s.pathname+="/"),s}function q(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let t=e.charAt(n.length);return t&&t!=="/"?null:e.slice(n.length)||"/"}const B=e=>e.join("/").replace(/\/\/+/g,"/"),$e=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),ke=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,He=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;class Re{register(n){return!0}}class Ee{constructor(n=[]){M(this,"middlewares",[]);this.middlewares=n||[]}addMiddleware(n){return n=Array.isArray(n)?n:[n],this.middlewares.push(...n),this}async execMiddlewares(n,t){return re(t.map(a=>async function(i,s){a.register(i)?a.handler(i,s):s()}))(n)}}class ee extends Ee{constructor(t){super(t.middlewares);M(this,"routes");M(this,"history");M(this,"basename");M(this,"lastHistoryUpdate");M(this,"location");M(this,"event",new ie);return this.routes=t.routes,this.basename=t.basename||"/",this.history=t.history||K(),this}start(){return this.lastHistoryUpdate?this:(this.history.listen(this.onHistoryLocationChange.bind(this)),this.onHistoryLocationChange({action:this.history.action,location:this.history.location}),this)}async onHistoryLocationChange(t,r=!1){var p;if(oe("basename",!(this.basename!=="/"&&t.location.pathname==="/"),"maybe you should navigate to "+this.basename),this.lastHistoryUpdate&&!r&&B([this.lastHistoryUpdate.location.pathname,this.lastHistoryUpdate.location.search])===B([t.location.pathname,t.location.search]))return;this.lastHistoryUpdate=t;let a=q(t.location.pathname,this.basename);if(a==null)return;const i=this.matchRoutes(a);if(Q(i))return;if(i[i.length-1].route.redirect){this.navigate(i[i.length-1].route.redirect,{replace:!0});return}const h={to:{pathname:a,search:t.location.search,hash:t.location.hash,state:t.location.state,key:t.location.key,action:t.action,matched:i,meta:i.reduce((b,u)=>Object.assign(b,u.route.meta),{}),params:Object.assign({},(p=i[i.length-1])==null?void 0:p.params)},from:this.location};await this.execMiddlewares(h,[...this.middlewares,{handler:async({to:b})=>{q(this.lastHistoryUpdate.location.pathname,this.basename)===b.pathname&&(this.location=b,this.event.emit("onLocationChange",b))},register:()=>!0}])}matchRoutes(t){var a;return(a=se(this.routes,{pathname:t}))==null?void 0:a.map(i=>Object.assign({},i,{params:Object.assign({},i.params)}))}addLocationListener(t){return this.event.on("onLocationChange",t),this.location&&t(this.location),this}removeLocationListener(t){this.event.remove("onLocationChange",t)}rematch(){this.lastHistoryUpdate&&this.onHistoryLocationChange(this.lastHistoryUpdate,!0)}setRoutes(t){return this.routes=t,this}getRoutes(){return this.routes}navigate(t,r){var a,i;if(typeof t=="number")this.history.go(t);else{let s=q(this.history.location.pathname,this.basename);if(s==null)return;let h=(i=(a=this.location)==null?void 0:a.matched)!=null?i:this.matchRoutes(s);if(Q(h))return;let p=Le(t,h.map(u=>u.pathnameBase),s);this.basename!=="/"&&(p.pathname=B([this.basename,p.pathname])),(r!=null&&r.replace?this.history.replace:this.history.push)(p,r==null?void 0:r.state)}}back(){this.navigate(-1)}}L.Middleware=Re,L.Router=ee,L.createBrowserHistory=K,L.createHashHistory=ne,L.createMemoryHistory=ae,L.default=ee,Object.defineProperties(L,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
